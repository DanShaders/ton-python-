import json
import pprint
import sys

from tl.tl_gen.lite_api.types import TonNode_blockIdExt
from tl.tl_gen.ton_api.types import Pk_aes, Pub_unenc, Id_config_local, Catchain_config_global, Engine_adnl, Engine_validator_electionBid, Engine_validator_config


with open('config.json') as f:
    config = json.load(f)

vc = Engine_validator_config.from_dict(config)
print(vc)
print(vc.to_json())

a = Engine_adnl(id_=b'\x01\x02'*16, category_=3)
print(a.to_dict())
print(a.to_json())
print(a.from_dict(a.to_dict()))

v = Engine_validator_electionBid(1, b'1234', b'1234', b'1234')
print(v.to_dict())
print(v.to_json())


block = TonNode_blockIdExt(workchain_=-1, shard_=0, seqno_=123456, root_hash_=b'\x01'*32, file_hash_=b'\x02'*32)

print(block)
print(block.to_dict())
block2 = TonNode_blockIdExt.from_dict(block.to_dict())

assert block == block2

pk = Pk_aes(key_=b'\x01'*32)

c = Id_config_local(id_=pk)
print(c)
print(c.to_dict())
c2 = Id_config_local.from_dict({'@type': 'id.config.local', 'id': {'@type': 'pk.aes', 'key': b'\x01'*32}})
print(c2)

assert c == c2

pubk = Pub_unenc(data_=b'\x12'*32)


cg = Catchain_config_global(tag_=b'123', nodes_=[pubk, pubk])
print(cg)
print(cg.to_dict())
cg2 = Catchain_config_global.from_dict(cg.to_dict())
print(cg2)

assert cg == cg2


from tl.tl_gen.lite_api.functions import LiteServer_getBlockHeaderRequest

req = LiteServer_getBlockHeaderRequest(id_=block, mode_=2)
print(req)
print(req.to_dict())
req2 = LiteServer_getBlockHeaderRequest.from_dict(req.to_dict())
print(req2)
assert req == req2


from tl.tl_gen.ton_api.types import Adnl_packetContents

pc = Adnl_packetContents(rand1_=b'\x01\x01', flags_=1, rand2_=b'\x01\x01', from__=pubk)
print(pc)
print(pc.to_dict())
pc2 = Adnl_packetContents.from_dict(pc.to_dict())
print(pc2)
assert pc == pc2

from tl.tlobject import BinaryReader
from tl.tl_gen.lite_api.alltlobjects import tlobjects
reader = BinaryReader(block.to_bytes()[4:], tl_objects=tlobjects)  # skip tag
blk2 = TonNode_blockIdExt.from_reader(reader)
print(blk2, block)
assert blk2 == block


from tl.tl_gen.lite_api.types import Adnl_message_answer, LiteServer_allShardsInfo, Adnl_message_query
res = b'\x16\x84\xac\x0fL\xf8\x89\xc3\xe2\x96,\xccms~6\x01\xbb\x1e9\xa7\xdcuv9S\xef\xe2K\x9b\xd8\x92:\x9b\x1c\x16\xfe\xbc\x02\x00-\xe7\x8f\t\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x80\xa8D4\x03\x8a\x12m\xc1\x12\x00\x86\xf8N\xb0\x82\x1eR\xfbS|0!\xed\x9b\xd9\xc9\xc4\xff\xfdJ@\x04~\x98\xe8\xec\xff\x8e\xf99{}\x87E\xe8\xed\xb2R\xbb.\x16\x85\xbaX\xbf\xbd\xeau\xe8\x1c\x18\x1c\x02L\xbc]\xda\n\xfe\xcf\x01\x00\xb5\xee\x9cr\x01\x02\x0e\x01\x00\x01\xc3\x00\tF\x03\x8a\x12m\xc1\x12\x00\x86\xf8N\xb0\x82\x1eR\xfbS|0!\xed\x9b\xd9\xc9\xc4\xff\xfdJ@\x04~\x98\xe8\xec\x00\x15\x01$\x10\x11\xefU\xaa\xff\xff\xff\x11\x02\x03\x04\x05(H\x01\x01\xe9N\xf9q\x1f\x1a\xe6\x9f\x87\xe1Mi\r"8%\xc5`\xc8\xf6E\xd6\x8f\xa8w\x104\xaa\x81\xf68\xfb\x00\x01(H\x01\x01\xab i\xf1\x1d+41H2\xb1\xaf_\x10\xc3<A\x12M%\xd0\xf2\x11\x06Y\xab\x0c\xab@\x144\xe9\x00\x03(H\x01\x01\xfe\x8b\x034\xdc\xbd\xe6G\x98\xe0\xa0H\x99\xce\x13}\xd4v\xab\xff?<\xaa\x9b\xfcWm\xe5\xdcv\xfc\xf9\x00\x14$\x89J3\xf6\xfd\x81\xb5\x00Q\x90\xeaN\xc8~7\xba\xaaO\x95e{\xa5\x083\xd8\x91\xfc\xd7\x82\xb8\xe9U\x03\xde\xe9x\xa4\xd9l\xdf\xd4cL\xae)k\xc1\xd6\x84A\xa5\xe8\xdc#\xa9CJ\xda4A\r\x8f\x8f\x18\x90\x1a#~\x87\xc0\x06\x07\x08\t(H\x01\x01U\x1f\x90\xcf\'6(_\x13\xd8\xbc+|^G?\xfa"v\xd6L@\xbd\xfa\xd55\x8f\x12\xe4j\x17\xb4\x00\x04\x00\x01\x02(H\x01\x01.\x9eh=*\xcc E\xbdN\x96\xc0\xf6M$\x1d\xfc\x95\xfe\xbem|j\x1a7+\xc8\xa3Kn\xb7\x1a\x00\x06#\x17\xcc\xa5h\xce\xa3H\xb6C\xb9\xac\xa0\x04\n\x0b\x0c(H\x01\x01\xc2\xb9*\xc6\xbc\xf3\x93P\xdbkpy?\x9e\x9b\xc5\xab8\x05L\xbb)\xdb \xca\\\xe4\x88\xce2\'`\x00\x02\x00?\xb0\x00\x00\x00\x00@\x00\x00\x00\x00\x00\x00\x00#:\x8d"\xd9\x0e\xe6\xb2\x80\x08\xce\xa3H\xb6C\xb9\xac\xa0\x04!\x01P\r(H\x01\x01H\xbe\x13\x1a\x00M*\xc0\xc8\xa1\xe0%\x95\xe9\x93)\xef\x95h\xd7\xf04\xce\x96\x10\xaa:\x82W2\x02\xcc\x00\x03\x00\x91\xb5\xee\x9cr\x01\x01\x04\x01\x00\x86\x00\x01\x01\xc0\x01\x01\x03\xd0@\x02\x01\xdbP\x1c\x001X\x19\xa2%@\x00\x01\xcd\x1bG\xf8\xa8\x00\x00\x01\xcd\x1bG\xf8\xa9\x11\xc6\xcdP:\x18\x99\xd1\xfdae%:O%B\xcf\xd5\x0e\x17\xe8\x83\xab\xe1I\xdf\xde\xc0C\x81\xe1\xa8\to\x11<^\xa7/\x04\xca\r0\x93\xbd\xb8\xcd\x9f\xf8\x85#\xe0\x7f"E\xd7\x08\x1f\xe8D\xc8\xf1\x0f\x80`\x00\x00\\ \xac\x00\x00\x00\x00\x00\x00\x00\x00\x19\xa2%#Hq.\n\x03\x00\x13Fu\x1aE\xb2\x1d\xcde\x00 \x00\x00'

reader = BinaryReader(res, tl_objects=tlobjects)
a: Adnl_message_answer =  reader.tgread_object()
reader = BinaryReader(a.answer, tl_objects=tlobjects)
l: LiteServer_allShardsInfo = reader.tgread_object()
assert l.id.workchain == -1
assert l.id.seqno == 53757096
assert l.id.shard == -9223372036854775808
assert l.id.root_hash == b'\xec\xe8\x98~\x04@J\xfd\xff\xc4\xc9\xd9\x9b\xed!0|S\xfbR\x1e\x82\xb0N\xf8\x86\x00\x12\xc1m\x12\x8a'

from tl.tl_gen.lite_api.functions import LiteServer_getAllShardsInfoRequest, LiteServer_queryRequest

res = b'z\xf9\x8b\xb4\x95\x90\xc6\xb3\xf1\xdfG\x1b2\x80X\x0f~\xaa\xe7\xe9\xf1\xdf\xb4\x9c\xd3C\xa5\xf8\xfcW\x0b\x9d\xd2%\x17\x97\\\xdf\x06\x8cyTk\xfd\xd3t\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x80HE4\x03\xaaV&GBy9>\x8c7\x1d\x91\x9f;\x14\x02\xbb\xf9\x94\x8c\xce~V\x15\x07B\xc7\xb7\xa8\x17v>\xf4\x1c\x0e\x86\xf4\xd51\xb0oM\rG\xc4\xbfN\xb6.\xd2\xcf\xb5\xfc\x9ef\xa9Ol\x80\xc6kr\x7f\xad\x00\x00\x00\x00\x00\x00'

reader = BinaryReader(res, tl_objects=tlobjects)

a: Adnl_message_query = reader.tgread_object()

reader = BinaryReader(a.query, tl_objects=tlobjects)
l: LiteServer_queryRequest = reader.tgread_object()
reader = BinaryReader(l.data, tl_objects=tlobjects)
r: LiteServer_getAllShardsInfoRequest = reader.tgread_object()
assert r.id.workchain == -1
assert r.id.seqno == 53757256
assert r.id.shard == -9223372036854775808
assert r.id.root_hash == b'>v\x17\xa8\xb7\xc7B\x07\x15V~\xce\x8c\x94\xf9\xbb\x02\x14;\x9f\x91\x1d7\x8c>9yBG&V\xaa'
